#!/usr/bin/env bpp

# Copyright (C) 2025 Andrew S. Rightenburg
# GNU General Public License v3.0
# This file is part of the Bash++ Standard Library.

## Simple Stack implementation
@class Stack {
	## @ignore
	@protected stack=()

	## Echo the number of elements in the stack.
	## @outputs The number of elements in the stack.
	@virtual @public @method size {
		echo "@{#this.stack[@]}"
	}

	## Push a value onto the top of the stack.
	## @param value The value to push onto the top of the stack.
	@virtual @public @method push value {
		@this.stack+=("$value")
	}

	## Pop the top element off the stack and echo it.
	## @outputs The value at the top of the stack.
	## @returns 1 if the stack is empty, 0 otherwise.
	@virtual @public @method pop {
		if [[ @{#this.stack[@]} -gt 0 ]]; then
			echo "@{this.stack[$((@{#this.stack[@]} - 1))]}"
			unset &@this.stack[$((@{#this.stack[@]} - 1))]
			return 0
		fi
		return 1
	}

	## Echo the top element of the stack without removing it.
	## @outputs The value at the top of the stack.
	## @returns 1 if the stack is empty, 0 otherwise.
	@virtual @public @method top {
		if [[ @{#this.stack[@]} -gt 0 ]]; then
			echo "@{this.stack[$((@{#this.stack[@]} - 1))]}"
			return 0
		fi
		return 1
	}

	## Clear the stack by removing all elements.
	@virtual @public @method clear {
		unset &@this.stack
	}

	## Silently check whether the stack is empty.
	## @outputs nothing
	## @returns 0 if the stack is empty, 1 otherwise.
	@virtual @public @method empty {
		if [[ @{#this.stack[@]} -eq 0 ]]; then
			return 0
		else
			return 1
		fi
	}
}
