#!/usr/bin/env bpp

# Copyright (C) 2025 Andrew S. Rightenburg
# GNU General Public License v3.0 or later (GPL-3.0-or-later)
# This file is part of the Bash++ Standard Library.

## @ignore
@class QueueNode {
	@public data
	@public @QueueNode* next
}

## Simple Queue implementation
@class Queue {
	## @ignore
	@protected @QueueNode* head
	## @ignore
	@protected @QueueNode* tail
	## @ignore
	@protected queueSize=0

	## Echo the number of elements in the queue.
	## @outputs The number of elements in the queue.
	@virtual @public @method size {
		echo "@this.queueSize"
	}

	## Silently check if the queue is empty.
	## @outputs nothing
	## @returns 0 if the queue is empty, 1 otherwise.
	@virtual @public @method empty {
		if [[ @this.queueSize -eq 0 ]]; then 
			return 0
		else
			return 1
		fi
	}

	##  Add a value to the end of the queue.
	## @param value The value to add to the queue.
	@virtual @public @method enqueue value {
		@QueueNode* node=@new QueueNode
		@node.data="$value"

		if [[ @this.queueSize -eq 0 ]]; then
			@this.head=@node
			@this.tail=@node
		else
			@this.tail.next=@node
			@this.tail=@node
		fi

		@this.queueSize=$((@this.queueSize + 1))
	}

	##  Remove and echo the value at the front of the queue.
	## @outputs The value at the front of the queue.
	## @returns 1 if the queue is empty, 0 otherwise.
	@virtual @public @method dequeue {
		if [[ @this.queueSize -gt 0 ]]; then
			@QueueNode* node=@this.head
			@this.head=@this.head.next
			@this.queueSize=$((@this.queueSize - 1))
			echo "@node.data"
			@delete @node
			return 0
		fi
		return 1
	}

	## Echo the value at the front of the queue.
	## @outputs The value at the front of the queue.
	## @returns 1 if the queue is empty, 0 otherwise.
	@virtual @public @method front {
		if [[ @this.queueSize -gt 0 ]]; then
			echo "@this.head.data"
			return 0
		fi
		return 1
	}

	## Echo the value at the back of the queue.
	## @outputs The value at the back of the queue.
	## @returns 1 if the queue is empty, 0 otherwise.
	@virtual @public @method back {
		if [[ @this.queueSize -gt 0 ]]; then
			echo "@this.tail.data"
			return 0
		fi
		return 1
	}

	## Clear the queue by removing all elements.
	@virtual @public @method clear {
		local size=@this.queueSize
		while [[ $size -gt 0 ]]; do
			@this.dequeue >/dev/null
			size=$((size - 1))
		done
	}
}
